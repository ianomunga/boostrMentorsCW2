//functionality ported to join.js